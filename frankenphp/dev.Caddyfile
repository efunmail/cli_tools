# $$      frankenphp -c dev.Caddyfile run
# $$ sudo frankenphp -c dev.Caddyfile run  # // for TLS/httpS

# // https://frankenphp.dev/docs/laravel/
{
  frankenphp

  # // TODO: Necessary??
  # order php_server before file_server
}

#localhost:8083 {  # // TLS
#my-dev.localhost:8083 {  # // TLS - httpS://my-dev.localhost:8083/mydir
:8083 {                   # //       http://localhost:8083/mydir/

  # // `handle_path` & `handle` - REF: https://caddyserver.com/docs/caddyfile/directives/handle_path

  #           _______ 
  handle_path /mydir* {
    # // EXAMPLE (basic) server: `python3 -m http.server -b 127.0.0.1 5311` 
    reverse_proxy 127.0.0.1:5311
    #             --------------
  }

  #           _______ 
  handle_path /flask* {
    # // Flask HELLO: `FLASK_APP=hello.py flask run` - https://flask.palletsprojects.com/en/3.0.x/quickstart/ 
    reverse_proxy 127.0.0.1:5000
    #             --------------
  }

  # ** [SPA] Single-Page App
  #           ______
  handle_path /vue* {
    # ** REDIRECT with `try_files`
    # // https://caddy.community/t/how-to-config-try-files/10657/2
    root * /var/www/secure/vue
    #try_files {path} {path}/ routes.html
    try_files {path} routes.html

    #file_server
  }

  handle {
    # Set the webroot to the public/ directory
    #root * public/
    root * /var/www/secure/
    #      ================

    # Enable compression (optional)
    encode zstd br gzip

    # Execute PHP files from the public/ directory and serve assets
    php_server
  }
}

# :8050 {
#   #reverse_proxy 127.0.0.1:5311 # // OKAY
#
#   handle_path /mydir* {  # // OKAY
#     reverse_proxy  127.0.0.1:5311
#   }
# }
